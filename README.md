# GearNet
 AAAI 2022: GearNet: Stepwise Dual Learning for Weakly Supervised Domain Adaptation. (Pytorch implementation)

## Requirements
* Python 3.8.3
* PyTorch 1.6.0
## Taining
All the commands are shown in `scripts` files.

## Results
| UNIF-20% | A -> W | A -> D |W -> A | W -> D |D -> A |D -> W | Average |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| Standard |0.6197|	0.6312	| 0.4861 |	0.9229 |	0.3164 |	0.8085 |	0.6308 |
| Co-teaching | 0.6158	| 0.6791	| 0.5614	| 0.9437 |	0.5482|	0.845|	0.6988|
| Jocor | 0.6653	| 0.7416	| 0.5237	| 0.9770	| 0.5028	| 0.9036	| 0.7190|
| DAN | 0.7031	 |0.7187	 |0.5809 |	0.9562	 |0.6299 |	0.9127 |	0.7502 |
| DANN | 0.7122|	0.7500|	0.6093|	0.9687|	0.6157	|0.9270	|0.7638 |
| TCL | 0.7773	|0.8166	|0.6075| 0.9812| 	0.6100 |	0.9361|	0.7881 |
| G+Co-teaching | 0.7343|	0.7791|	0.6058	|0.9500|	0.6051	|0.9036|	0.7629 |
| G+DANN | 0.7552|	0.7916|	0.6175|	0.9729|	0.6139|	0.9361	|0.7812 |
| G+TCL | 0.8177	|0.8437|	0.6168|	0.9875|	0.6225	|0.9518	|0.8066|

| UNIF-40% | A -> W | A -> D |W -> A | W -> D |D -> A |D -> W | Average |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| Standard |0.5585	|0.5833	|0.4098	|0.8145	|0.3870|	0.7330|	0.5810|
| Co-teaching | 0.5937|	0.6583|	0.4971|	0.8500|	0.3338	|0.5598|	0.5821|
| Jocor | 0.6302	|0.6625|	0.4723	|0.9562	|0.4524|	0.8307	|0.6673|
| DAN | 0.6380|	0.6708|	0.5071|	0.8916|	0.5951|	0.8971	|0.6999 |
| DANN | 0.6731|	0.7062|	0.5223|	0.9250|	0.5696	|0.8893|	0.7142|
| TCL | 0.7656|	0.7562|	0.5106|	0.9437|	0.5600|	0.8880|	0.7373|
| G+Co-teaching | 0.6979|	0.7250|	0.5507|	0.8583|	0.3465|	0.5833|	0.6269 |
| G+DANN | 0.7434|	0.7229|	0.5326|	0.9500|	0.5742|	0.9049|	0.7380 |
| G+TCL | 0.7968	 |0.7916	 |0.4907 |	0.9458 |	0.5312 |	0.9322 |	0.7480 |

| Flip-20% | A -> W | A -> D |W -> A | W -> D |D -> A |D -> W | Average |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| Standard |0.6015|	0.6187|	0.4421|	0.9062|	0.4005	|0.7929|	0.6269|
| Co-teaching | 0.6054|	0.6187	|0.5191|	0.8625|	0.4609|	0.7070|	0.6289|
| Jocor |0.6484	|0.6937|	0.4847|	0.8541|	0.3469	|0.7421|	0.6283|
| DAN | 0.6614|	0.677|	0.5500|	0.8812|	0.5802	|0.8710|	0.7034 |
| DANN | 0.6601|	0.6541|	0.5312|	0.877	|0.5717|	0.8645|	0.6931|
| TCL |0.7526	|0.7833	|0.5767|	0.9229	|0.6029|	0.9322|	0.76176|
| G+Co-teaching |0.7473|	0.6791|	0.5671|	0.8770|	0.4989|	0.763|	0.6887 |
| G+DANN | 0.7265|	0.7312|	0.5539	|0.8854	|0.5951|	0.8945|	0.7311 |
| G+TCL | 0.8776|	0.8291|	0.5873|	0.9395|	0.6072|	0.9479|	0.7981 |

| Flip-40% | A -> W | A -> D |W -> A | W -> D |D -> A |D -> W | Average |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| Standard |0.4687|	0.4812|	0.3547|	0.7208|	0.3504|	0.6328|	0.5014|
| Co-teaching | 0.5039|	0.525|	0.3615|	0.5729|	0.2929|	0.4257|	0.4469|
| Jocor |0.5429|	0.602|	0.4595|	0.7125|	0.3892|	0.6914|	0.5662|
| DAN | 0.5312	|0.5458	|0.4218	|0.7187|	0.4353|	0.6679|	0.5534|
| DANN |0.5143|	0.5062|	0.4232|	0.6937|	0.4222|	0.6757|	0.5392|
| TCL |0.6601|	0.6166|	0.4595|	0.7625|	0.4335|	0.6497|	0.5969|
| G+Co-teaching |0.5742|	0.5104|	0.3806	|0.5666	|0.3164|	0.4283|	0.4627 |
| G+DANN | 0.5494	|0.5208	|0.4261|	0.7354|	0.4375|	0.6731	|0.5570|
| G+TCL | 0.6992|	0.6270|	0.4630|	0.7541|	0.4225|	0.6601	|0.6043|
## Citation
If you find this useful in your research, please consider citing:
```
@article{xie2022gearnet,
  title={GearNet: Stepwise Dual Learning for Weakly Supervised Domain Adaptation},
  author={Xie, Renchunzi and Wei, Hongxin and Feng, Lei and An, Bo},
  journal={AAAI},
  year={2022}
}
```

## Contact
If you have any problems about our code, feel free to contact<br>

* XIER0002@e.ntu.edu.sg

or describe your problem in Issues.
